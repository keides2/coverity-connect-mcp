# Coverity Connect MCP Server - ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸

**Version**: 1.0.0  
**ä½œæˆæ—¥**: 2025å¹´7æœˆ21æ—¥  
**æ›´æ–°æ—¥**: 2025å¹´7æœˆ21æ—¥

## ğŸ“‹ ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    MCP Protocol     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    REST/SOAP API    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚                  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚                 â”‚
â”‚  Claude Desktop â”‚                     â”‚   MCP Server     â”‚                     â”‚ Coverity Connectâ”‚
â”‚   AI Assistant  â”‚                     â”‚  (main.py)       â”‚                     â”‚  (Black Duck)   â”‚
â”‚                 â”‚                     â”‚                  â”‚                     â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                                                â”‚ HTTP Client
                                                â–¼
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚  CoverityClient  â”‚
                                        â”‚ (coverity_client â”‚
                                        â”‚      .py)        â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Presentation Layer                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   MCP Tools     â”‚  â”‚  MCP Resources  â”‚  â”‚   CLI Interface â”‚ â”‚
â”‚  â”‚   (8 tools)     â”‚  â”‚   (2 resources) â”‚  â”‚    (Click)      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Service Layer                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   FastMCP       â”‚  â”‚  Initialization â”‚  â”‚   Error         â”‚ â”‚
â”‚  â”‚   Framework     â”‚  â”‚   Management    â”‚  â”‚   Handling      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Data Access Layer                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ CoverityClient  â”‚  â”‚  HTTP Session   â”‚  â”‚  Authentication â”‚ â”‚
â”‚  â”‚  (async)        â”‚  â”‚  Management     â”‚  â”‚   (Basic Auth)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Infrastructure Layer                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚    aiohttp      â”‚  â”‚      SSL/TLS    â”‚  â”‚     Logging     â”‚ â”‚
â”‚  â”‚  HTTP Client    â”‚  â”‚   Certificate   â”‚  â”‚   (structured)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—ï¸ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ

### ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### 1. MCP Server (main.py)
**è²¬å‹™**: MCPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®å®Ÿè£…ã¨ãƒ„ãƒ¼ãƒ«/ãƒªã‚½ãƒ¼ã‚¹ã®æä¾›
**ä¸»è¦æ©Ÿèƒ½**:
- FastMCPã‚µãƒ¼ãƒãƒ¼ã®åˆæœŸåŒ–ã¨è¨­å®š
- 8ã¤ã®MCPãƒ„ãƒ¼ãƒ«ã®å®Ÿè£…
- 2ã¤ã®MCPãƒªã‚½ãƒ¼ã‚¹ã®å®Ÿè£…
- Coverity Clientã®ç®¡ç†
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ã‚°å‡ºåŠ›

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:
```python
def initialize_client() -> CoverityClient
def create_server() -> FastMCP
def run_server() -> None
def cli() -> None  # Click CLI interface
```

#### 2. Coverity Client (coverity_client.py)
**è²¬å‹™**: Coverity Connect REST APIã¨ã®é€šä¿¡
**ä¸»è¦æ©Ÿèƒ½**:
- éåŒæœŸHTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ç®¡ç†
- SSL/TLSæ¥ç¶šã®å‡¦ç†
- èªè¨¼ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ã®æ­£è¦åŒ–
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:
```python
async def _make_request(method: str, endpoint: str, params: Dict, data: Dict) -> Dict
async def get_projects() -> List[Dict]
async def get_streams(project_id: str) -> List[Dict]
async def get_defects(stream_id: str, query: str, filters: Dict, limit: int) -> List[Dict]
async def get_users(disabled: bool, include_details: bool, locked: bool, limit: int) -> List[Dict]
```

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```
[User Request] 
    â†“
[Claude Desktop - MCP Protocol]
    â†“
[FastMCP Framework]
    â†“
[MCP Tool/Resource Handler]
    â†“
[initialize_client()]
    â†“
[CoverityClient._make_request()]
    â†“
[aiohttp HTTP Session]
    â†“
[Coverity Connect REST API]
    â†“
[Response Processing]
    â†“
[JSON Response to User]
```

## ğŸ”§ æŠ€è¡“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³

#### Session Management
```python
class CoverityClient:
    def __init__(self):
        self._session: Optional[aiohttp.ClientSession] = None
    
    async def _get_session(self) -> aiohttp.ClientSession:
        if self._session is None or self._session.closed:
            # SSL context creation
            ssl_context = ssl.create_default_context()
            ssl_context.check_hostname = False
            ssl_context.verify_mode = ssl.CERT_NONE
            
            # Authentication setup
            auth = aiohttp.BasicAuth(self.username, self.password)
            
            # Session creation with timeout
            timeout = aiohttp.ClientTimeout(total=30)
            
            self._session = aiohttp.ClientSession(
                auth=auth,
                timeout=timeout,
                connector=aiohttp.TCPConnector(ssl=ssl_context),
                headers={'Accept': 'application/json', 'Content-Type': 'application/json'}
            )
        return self._session
```

#### Context Manager Pattern
```python
async def __aenter__(self):
    return self

async def __aexit__(self, exc_type, exc_val, exc_tb):
    await self.close()
```

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥

```python
async def _make_request(self, method: str, endpoint: str, params: Dict = None, data: Dict = None) -> Dict:
    try:
        async with session.request(method, url, **kwargs) as response:
            if response.status == 200:
                return await response.json()
            elif response.status == 401:
                raise Exception("Authentication failed - check credentials")
            elif response.status == 404:
                logger.warning(f"Resource not found: {url}")
                return {}
            else:
                text = await response.text()
                raise Exception(f"HTTP {response.status}: {text}")
    except aiohttp.ClientError as e:
        logger.error(f"Request failed: {e}")
        raise Exception(f"Connection error: {e}")
```

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### èªè¨¼ãƒ•ãƒ­ãƒ¼
```
[Environment Variables] â†’ [CoverityClient.__init__] â†’ [aiohttp.BasicAuth] â†’ [HTTP Headers]
```

### SSL/TLSè¨­å®š
```python
ssl_context = ssl.create_default_context()
# For development/testing with self-signed certificates
ssl_context.check_hostname = False  
ssl_context.verify_mode = ssl.CERT_NONE
```

### æ©Ÿå¯†æƒ…å ±ç®¡ç†
- ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹èªè¨¼æƒ…å ±ã®å¤–éƒ¨åŒ–
- ãƒ¡ãƒ¢ãƒªå†…ã§ã®èªè¨¼æƒ…å ±ã®æœ€å°é™ä¿æŒ
- ãƒ­ã‚°å‡ºåŠ›æ™‚ã®æ©Ÿå¯†æƒ…å ±ãƒã‚¹ã‚­ãƒ³ã‚°

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°

| æ©Ÿèƒ½ | MCPãƒ„ãƒ¼ãƒ« | HTTPãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ |
|------|-----------|--------------|----------------|
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ | `list_projects` | GET | `/api/viewContents/projects/v1` |
| ã‚¹ãƒˆãƒªãƒ¼ãƒ ä¸€è¦§ | `list_streams` | GET | `/api/viewContents/streams/v1` |
| æ¬ é™¥æ¤œç´¢ | `search_defects` | GET | `/api/viewContents/issues/v1` |
| æ¬ é™¥è©³ç´° | `get_defect_details` | GET | `/api/viewContents/issues/v1/{cid}` |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ | `list_users` | GET | `/api/v2/users` |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´° | `get_user_details` | GET | `/api/v2/users/{username}` |

### ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

#### Project Model
```typescript
interface Project {
  projectKey: string;
  projectName: string;
  description?: string;
  createdDate: string;
  lastModified: string;
  streams?: string[];
}
```

#### Defect Model
```typescript
interface Defect {
  cid: string;
  checkerName: string;
  displayType: string;
  displayImpact: "High" | "Medium" | "Low";
  displayStatus: string;
  displayFile: string;
  displayFunction: string;
  firstDetected: string;
  streamId: string;
  events?: DefectEvent[];
}
```

#### User Model
```typescript
interface User {
  name: string;
  email: string;
  familyName: string;
  givenName: string;
  disabled: boolean;
  locked: boolean;
  superUser: boolean;
  groupNames: string[];
  roleAssignments: RoleAssignment[];
  lastLogin: string;
  dateCreated: string;
  local: boolean;
}
```

## ğŸ”„ è¨­å®šç®¡ç†ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ç’°å¢ƒå¤‰æ•°éšå±¤
```
1. CLIå¼•æ•° (æœ€é«˜å„ªå…ˆåº¦)
2. ç’°å¢ƒå¤‰æ•°
3. .env ãƒ•ã‚¡ã‚¤ãƒ« 
4. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ (æœ€ä½å„ªå…ˆåº¦)
```

### è¨­å®šé …ç›®
```python
# å¿…é ˆè¨­å®š
COVERITY_HOST: str          # Coverity Connect ã‚µãƒ¼ãƒãƒ¼ãƒ›ã‚¹ãƒˆ
COVAUTHUSER: str           # èªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼å  
COVAUTHKEY: str            # èªè¨¼ã‚­ãƒ¼

# ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®š
COVERITY_PORT: int = 8080         # ã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ãƒˆ
COVERITY_SSL: bool = True         # SSLä½¿ç”¨
COVERITY_BASE_DIR: str           # ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹
PROXY_HOST: str                  # ãƒ—ãƒ­ã‚­ã‚·ãƒ›ã‚¹ãƒˆ
PROXY_PORT: str                  # ãƒ—ãƒ­ã‚­ã‚·ãƒãƒ¼ãƒˆ
LOG_LEVEL: str = "INFO"          # ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«
```

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### é–‹ç™ºç’°å¢ƒ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Claude        â”‚    â”‚   MCP Server    â”‚    â”‚   Mock Server   â”‚
â”‚   Desktop       â”‚â—„â”€â”€â–ºâ”‚   (localhost)   â”‚â—„â”€â”€â–ºâ”‚   (port 5000)   â”‚
â”‚                 â”‚    â”‚   (dev mode)    â”‚    â”‚   (dummy data)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æœ¬ç•ªç’°å¢ƒ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Claude        â”‚    â”‚   MCP Server    â”‚    â”‚   Coverity      â”‚
â”‚   Desktop       â”‚â—„â”€â”€â–ºâ”‚   (systemd)     â”‚â—„â”€â”€â–ºâ”‚   Connect       â”‚
â”‚                 â”‚    â”‚   (production)  â”‚    â”‚   (enterprise)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DockeråŒ–ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
```dockerfile
FROM python:3.11-slim
WORKDIR /app
COPY . /app
RUN pip install -e .
EXPOSE 8000
CMD ["coverity-mcp-server"]
```

## ğŸ“ˆ ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£è¨­è¨ˆ

### æ¥ç¶šãƒ—ãƒ¼ãƒ«ç®¡ç†
```python
# aiohttp connector configuration
connector = aiohttp.TCPConnector(
    limit=10,                    # ç·æ¥ç¶šæ•°åˆ¶é™
    limit_per_host=5,           # ãƒ›ã‚¹ãƒˆåˆ¥æ¥ç¶šæ•°åˆ¶é™
    ttl_dns_cache=300,          # DNS ã‚­ãƒ£ãƒƒã‚·ãƒ¥TTL
    use_dns_cache=True          # DNS ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½¿ç”¨
)
```

### ãƒ¡ãƒ¢ãƒªç®¡ç†
- éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«ã‚ˆã‚‹ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–
- ã‚»ãƒƒã‚·ãƒ§ãƒ³å†åˆ©ç”¨ã«ã‚ˆã‚‹ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰å‰Šæ¸›
- ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹é–‹ç™ºç’°å¢ƒã§ã®è»½é‡åŒ–

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™
```python
# ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š
CLIENT_TIMEOUT = 30             # HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
SESSION_TIMEOUT = 300           # ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
MAX_RETRIES = 3                 # æœ€å¤§ãƒªãƒˆãƒ©ã‚¤å›æ•°

# åˆ¶é™å€¤
MAX_DEFECTS_PER_QUERY = 1000    # ä¸€å›ã®ã‚¯ã‚¨ãƒªã§ã®æœ€å¤§æ¬ é™¥æ•°
MAX_USERS_PER_QUERY = 200       # ä¸€å›ã®ã‚¯ã‚¨ãƒªã§ã®æœ€å¤§ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°
DEFAULT_PAGE_SIZE = 50          # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚º
```

## ğŸ”§ ç›£è¦–ãƒ»ãƒ­ã‚°ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ãƒ­ã‚°æ§‹é€ 
```python
# æ§‹é€ åŒ–ãƒ­ã‚°è¨­å®š
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)

# ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«éšå±¤
DEBUG: è©³ç´°ãªãƒ‡ãƒãƒƒã‚°æƒ…å ±
INFO:  ä¸€èˆ¬çš„ãªæƒ…å ±ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
WARNING: è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
ERROR: ã‚¨ãƒ©ãƒ¼æƒ…å ±
CRITICAL: è‡´å‘½çš„ãªã‚¨ãƒ©ãƒ¼
```

### ç›£è¦–ãƒã‚¤ãƒ³ãƒˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Application   â”‚
â”‚   Metrics       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Request Count â”‚
â”‚ â€¢ Response Time â”‚
â”‚ â€¢ Error Rate    â”‚
â”‚ â€¢ Active Users  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   System        â”‚
â”‚   Metrics       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ CPU Usage     â”‚
â”‚ â€¢ Memory Usage  â”‚
â”‚ â€¢ Network I/O   â”‚
â”‚ â€¢ Disk I/O      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ãƒ†ã‚¹ãƒˆæˆ¦ç•¥
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Unit Tests    â”‚
â”‚   (pytest)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Function      â”‚
â”‚ â€¢ Class Method  â”‚
â”‚ â€¢ Error Handlingâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Integration     â”‚
â”‚ Tests           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ API Endpoints â”‚
â”‚ â€¢ End-to-End    â”‚
â”‚ â€¢ Mock Server   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Performance     â”‚
â”‚ Tests           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Load Testing  â”‚
â”‚ â€¢ Stress Testingâ”‚
â”‚ â€¢ Memory Leaks  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Mock Data Strategy
```python
# é–‹ç™ºç’°å¢ƒç”¨ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿
DUMMY_PROJECTS = [
    {
        'projectKey': 'test-project-1',
        'projectName': 'Test Project 1',
        'description': 'First test project'
    }
]

DUMMY_USERS = [
    {
        'name': 'admin',
        'superUser': True,
        'groupNames': ['Administrators']
    }
]
```

## ğŸ“‹ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ±ºå®šè¨˜éŒ² (ADR)

### ADR-001: éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®æ¡ç”¨
**æ±ºå®š**: aiohttp + asyncio ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¡ç”¨
**ç†ç”±**: 
- è¤‡æ•°ã®HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’åŠ¹ç‡çš„ã«å‡¦ç†
- Coverity Connectã®å¿œç­”å¾…æ©Ÿæ™‚é–“ã®æœ€é©åŒ–
- MCPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¨ã®è¦ªå’Œæ€§

### ADR-002: FastMCP ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®é¸æŠ
**æ±ºå®š**: mcp ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«åŠ ãˆã¦FastMCPä½¿ç”¨
**ç†ç”±**:
- ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç°¡æ½”ãªAPIå®šç¾©
- è‡ªå‹•çš„ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- é–‹ç™ºåŠ¹ç‡ã®å‘ä¸Š

### ADR-003: ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç®¡ç†
**æ±ºå®š**: ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã®CoverityClientç®¡ç†
**ç†ç”±**:
- ã‚»ãƒƒã‚·ãƒ§ãƒ³å†åˆ©ç”¨ã«ã‚ˆã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š
- èªè¨¼æƒ…å ±ã®ä¸€å…ƒç®¡ç†
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®æœ€é©åŒ–

### ADR-004: ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
**æ±ºå®š**: æœ¬ç•ªAPIå¤±æ•—æ™‚ã®ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿è¿”å´
**ç†ç”±**:
- é–‹ç™ºç’°å¢ƒã§ã®ç¶™ç¶šæ€§ç¢ºä¿
- ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³èƒ½åŠ›
- ã‚¨ãƒ©ãƒ¼æ™‚ã®ã‚°ãƒ¬ãƒ¼ã‚¹ãƒ•ãƒ«å‹•ä½œ

## ğŸ”„ ä»Šå¾Œã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£é€²åŒ–

### Phase 1: ç¾åœ¨ (v1.0)
- åŸºæœ¬MCPå®Ÿè£…
- REST APIçµ±åˆ
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†æ©Ÿèƒ½

### Phase 2: æ‹¡å¼µ (v1.1-1.2)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Cache Layer   â”‚
â”‚   (Redis)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Rate Limiting â”‚
â”‚   & Throttling  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 3: é«˜åº¦åŒ– (v2.0)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ML Pipeline   â”‚    â”‚   GraphQL API   â”‚
â”‚   (AI Analysis) â”‚    â”‚   Gateway       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Event Stream  â”‚    â”‚   Plugin        â”‚
â”‚   (WebSocket)   â”‚    â”‚   Architecture  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**ã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸ã¯ã€Coverity Connect MCP Serverã®å…¨ä½“è¨­è¨ˆæ€æƒ³ã€æŠ€è¡“é¸æŠã€å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åŒ…æ‹¬çš„ã«èª¬æ˜ã—ã¦ã„ã¾ã™ã€‚éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆãªã©ã€å®Ÿè£…ã®é‡è¦ãªå´é¢ã‚’ã™ã¹ã¦ç¶²ç¾…ã—ã¦ã„ã¾ã™ã€‚**